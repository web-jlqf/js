<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Aproximación de e^x (serie)</title>
</head>
<body>
  <form action="javascript:getAproximacion();">
    <label for="input1">Ingresa n (entero ≥ 0):</label>
    <input type="number" id="input1" placeholder="p.e. 20" required /><br><br>

    <label for="input2">Ingresa x (real):</label>
    <input type="number" id="input2" placeholder="p.e. 1.5" step="any" required /><br><br>

    <label for="output">Resultado:</label>
    <input type="text" id="output" readonly /><br><br>

    <input type="submit" value="Calcular">
  </form>

  <script>
    /* ============================
       Declaración de funciones
       ============================ */

    // k! (versión iterativa)
    function factorial(n) {
      let fact = 1;
      for (let i = 2; i <= n; i++) fact *= i;
      return fact;
    }

    // base^exp (versión iterativa)
    function potencia(base, exp) {
      if (exp === 0) return 1;
      let pot = 1;
      for (let i = 1; i <= exp; i++) pot *= base;
      return pot;
    }

    // Suma parcial de la serie de e^x: sum_{k=0..n} (x^k / k!)
    function aproximacion(n, x) {
      let suma = 0;
      for (let k = 0; k <= n; k++) {
        suma += potencia(x, k) / factorial(k); // <-- CORREGIDO: x^k/k!
      }
      return suma;
    }

    /* ============================
       Uso
       ============================ */

    function getAproximacion() {
      const nStr = document.getElementById("input1").value;
      const xStr = document.getElementById("input2").value;

      const n = parseInt(nStr, 10);
      const x = parseFloat(xStr);

      // Validaciones básicas
      if (!Number.isInteger(n) || n < 0) {
        alert("n debe ser un entero ≥ 0");
        return;
      }
      if (!Number.isFinite(x)) {
        alert("x debe ser un número real");
        return;
      }

      const r = aproximacion(n, x);
      document.getElementById("output").value = r.toFixed(10);
      console.log({ n, x, resultado: r });
    }
  </script>
</body>
</html>
